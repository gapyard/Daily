<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#0f172a;color:#e2e8f0}
    .container{max-width:900px;margin:0 auto;padding:20px;display:grid;gap:16px}
    h1{text-align:center;margin:0 0 12px}
    .card{background:#111827;border:1px solid #1f2937;border-radius:14px;padding:16px}
    label{font-size:13px;color:#94a3b8;display:block;margin:10px 0 6px}
    input,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid #374151;background:#0b1220;color:#e2e8f0}
    textarea{min-height:80px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    button{border:0;border-radius:8px;padding:8px 12px;cursor:pointer}
    .primary{background:#2563eb;color:#fff}
    .danger{background:#dc2626;color:#fff}
    .ghost{background:#1f2937;color:#e5e7eb;font-size:12px;padding:4px 8px}
    /* timeline */
    #timelineList{display:grid;gap:8px}
    .timeline-item{display:flex;align-items:center;gap:8px;background:#0b1220;border:1px solid #1f2937;border-radius:10px;padding:8px}
    .timeline-text{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px}
    .thumbs{display:flex;gap:4px}
    .thumbs img{width:32px;height:32px;object-fit:cover;border-radius:6px;cursor:pointer;border:1px solid #374151}
    .actions{display:flex;gap:4px}
    /* lightbox */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:50}
    .lightbox img{max-width:92vw;max-height:92vh;border-radius:10px}
  </style>
</head>
<body>
<div class="container">
  <h1>üìñ ‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà</h1>

  <div class="card">
    <div class="row">
      <div>
        <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="date" id="date">
      </div>
      <div>
        <label>‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</label>
        <div id="weekday" style="margin-top:10px;font-size:13px;color:#94a3b8">‚Äî</div>
      </div>
    </div>
    <div class="row">
      <div>
        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</label>
        <input id="place" list="placeList">
        <datalist id="placeList"></datalist>
      </div>
      <div>
        <label>‡πÇ‡∏ô‡πâ‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</label>
        <input id="place_note">
      </div>
    </div>
    <div class="row">
      <div>
        <label>‡∏Å‡∏¥‡∏ô‡∏≠‡∏∞‡πÑ‡∏£</label>
        <input id="food">
      </div>
      <div></div>
    </div>
    <div>
      <label>‡πÇ‡∏ô‡πâ‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</label>
      <textarea id="notes"></textarea>
    </div>
    <div>
      <label>‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3)</label>
      <input type="file" id="photosInput" accept="image/*" multiple>
      <div id="photosPreview" class="thumbs" style="margin-top:6px"></div>
    </div>
    <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
      <button class="primary" id="saveBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
      <button id="loadBtn">‡πÇ‡∏´‡∏•‡∏î</button>
      <button class="danger" id="clearBtn">‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
    </div>
  </div>

  <div class="card">
    <h3 style="margin:0 0 8px;font-size:15px">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h3>
    <div id="timelineList"></div>
  </div>
</div>

<div id="lightbox" class="lightbox" onclick="this.style.display='none'">
  <img id="lightboxImg" src="">
</div>

<script>
const $=id=>document.getElementById(id);
const WEEK=["‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå","‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå","‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£","‡∏û‡∏∏‡∏ò","‡∏û‡∏§‡∏´‡∏±‡∏™","‡∏®‡∏∏‡∏Å‡∏£‡πå","‡πÄ‡∏™‡∏≤‡∏£‡πå"];
const today=()=>new Date().toISOString().slice(0,10);
const db=()=>JSON.parse(localStorage.getItem("diary")||"{}");
function saveDB(d){localStorage.setItem("diary",JSON.stringify(d));}

function updateWeekday(){const d=new Date($("date").value);$("weekday").textContent=isNaN(d)?"‚Äî":WEEK[d.getDay()];}

async function resize(file){return new Promise(r=>{const fr
